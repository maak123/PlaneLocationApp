﻿@{ ViewBag.Title = "Home Page"; }
<script src="https://cdnjs.cloudflare.com/ajax/libs/knockout/3.5.1/knockout-latest.js" integrity="sha512-2AL/VEauKkZqQU9BHgnv48OhXcJPx9vdzxN1JrKDVc4FPU/MEE/BZ6d9l0mP7VmvLsjtYwqiYQpDskK9dG8KBA==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous"></script>
<p>
    <a asp-action="Create">Add new Sighting</a>
</p>
<table class="table">
    <thead>
        <tr>
            <th>
                Make
            </th>
            <th>
                Model
            </th>
            <th>
                Registration
            </th>
            <th>
                Location
            </th>
            <th>
                Date And Time
            </th>

            <th></th>
        </tr>
    </thead>
    <tbody data-bind="foreach: planeLocations">

        <tr>
            <td data-bind="text: make">
            </td>
            <td data-bind="text: model">
            </td>
            <td data-bind="text: registration">
            </td>
            <td data-bind="text: location">
            </td>
            <td data-bind="text: dateAndTime">
            </td>

            <td>
                <a class="pr-2" data-bind="attr: { href:  '/PlaneDetails/Edit/'+ id }">
                    Edit
                </a>
                <a class="pr-2" data-bind="attr: { href:  '/PlaneDetails/Delete/'+ id }">
                    Delete
                </a>
                <a class="pr-2" data-bind="attr: { href:  '/PlaneDetails/Details/'+ id }">
                    Details
                </a>

            </td>
        </tr>

    </tbody>
</table>

<script type="text/javascript">


    $(document).ready(function () {
        getPlaneLocations();
    });

    function getPlaneLocations() {
        var viewModel = {
        };

        $.ajax({
            url: "/api",
            dataType: 'json'
        }).done(function (data) {

            viewModel.planeLocations = ko.observableArray(data);
            ko.applyBindings(viewModel);

        }).error(function () {
        });

    }



</script>